name: NGINX Based on Apache 2.2 Server for UNIX Security Technical Implementation Guide
title: NGINX Based on Apache 2.2 Server for UNIX Security Technical Implementation Guide
maintainer: The CMS InSpec Dev Teams
copyright: (c) 2018 The MITRE Corporation
copyright_email: inspec@mitre.org
license: Apache-2.0
summary: CMS ARS 3.1 overlay for NGINX based on Apache 2.2 Server for UNIX DISA STIG.
version: 0.1.0

depends:
- name: nginx-baseline
  git: https://github.com/mitre/nginx-baseline
  branch: master

attributes:
- name: nginx_conf_file	
  description: Path for the nginx configuration file
  type: string
  default: '/etc/nginx/nginx.conf'

- name: nginx_backup_repository
  description: Path to nginx backup repository
  type: string
  default: '/usr/share/nginx/html'

- name: dmz_subnet
  description: Subnet of the DMZ
  type: string
  default: '62.0.0.0/24'

- name: nginx_min_ver
  description: Minimum Web vendor-supported version.
  type: string
  default: '1.12.0'

- name: nginx_owner
  description: Nginx owner
  type: string
  default: 'nginx'

- name: nginx_group
  description: The Nginx group
  type: string
  default: 'nginx'

- name: sys_admin
  description: The system adminstrator
  string: array
  default: ['root','centos']

- name: sys_admin_group
  description: The system adminstrator group,
  type; string
  default: 'root'

- name: authorized_user_list
  description: List of non admin user accounts
  type: array
  default: ['user']

- name: monitoring_software
  description: Monitoring software for CGI or equivalent programs,
  type: array
  default: ['audit', 'auditd']

- name: disallowed_packages_list
  description: 'List of disallowed packages',
  type: array
  default: ['postfix']

- name: disallowed_compiler_list
  description: List of disallowed compilers
  type: array
  default: ['gcc']

- name: dod_approved_pkis
  description: DoD-approved PKIs (e.g., DoD PKI, DoD ECA, and DoD-approved external partners.
  type: array
  default: ['DoD','ECA']

- name: nginx_disallowed_file_list
  description: File list of  documentation, sample code, example applications, and tutorials.
  type: array
  default: ['/usr/share/man/man8/nginx.8.gz']

- name: nginx_allowed_file_list
  description: File list of allowed documentation, sample code, example applications, and tutorials.
  type: array
  default: []

- name: ngix_authorized_modules
  description: List of  authorized nginx modules.
  type: array
  default: ['http_addition',
     'http_auth_request',
     'http_dav',
     'http_flv',
     'http_gunzip',
     'http_gzip_static',
     'http_mp4',
     'http_random_index',
     'http_realip',
     'http_secure_link',
     'http_slice',
     'http_ssl',
     'http_stub_status',
     'http_sub',
     'http_v2',
     'mail_ssl',
     'stream_realip',
     'stream_ssl',
     'stream_ssl_preread']

- name: nginx_unauthorized_modules
  description: List of  unauthorized nginx modules.
  type: array
  default: []

- name: nginx_path
  description: Path for the nginx binary
  type: string
  default: '/usr/sbin/nginx'

- name: ocsp_server
  description: domain and port to the OCSP Server
  type: string
  default: 'login.live.com:443'

- name: crl_update_frequency
  description: Frequency at which CRL is updated in days
  type: numeric
  default: 7